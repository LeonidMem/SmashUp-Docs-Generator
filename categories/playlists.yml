header: 'Плейлисты'

requests:
  get:
    name: 'Получить'
    link: '[GET] /playlist/get?id=[IDS]'
    description: 'Возвращает списком сериализованные плейлисты.'

    request: '/playlist/get?id=689,964'
    answer:
      - id: 689
        name: 'Пылесосен'
        owner: 'LeonidM'
        imageUrl: 'default'
        description: ''
        streams: 0
        likes: 0
        tracks: [340, 648]
      - id: 964
        name: 'Убиты, но не вами'
        owner: 'LeonidM'
        imageUrl: '44abc4f77cae0585df37f8e7437f064c9c568a62b98da3c7029dc66bfd934709'
        description: ''
        streams: 7
        likes: 1
        tracks: [368, 509, 156, 114, 591, 377, 144, 376]

    regex:
      IDS: '\d+(?:,\d+){0,}'

    codes:
      200:
        - Если всё хорошо и слава тебе, Господи
      400:
        - Если некорректно указаны ID
        - Если хотя бы один из указанных ID не является ID какого-либо мэшапа


  create:
    mark: 'T'
    name: 'Создать'
    link: '[GET] /playlist/create'
    description: 'В случае успешного создания плейлиста, возвращает его в сериализованном виде, иначе пустую строку.'

    answer:
      id: 1294
      name: 'Новый плейлист'
      owner: 'LeonidM'
      imageUrl: 'default'
      description: ''
      streams: 0
      likes: 0
      mashups: []

    codes:
      200:
        - Если плейлист был создан
      400:
        - Если у пользователя уже есть 10 плейлистов и при этом нет особых прав *(верификация, модератор, администратор)*
      500:
        - Если произошла ошибка при создании плейлиста


  delete:
    mark: 'T'
    name: 'Удалить'
    link: '[GET] /playlist/delete?id=[ID]'

    regex:
      ID: '\d+'

    codes:
      200:
        - Если плейлист был удалён
      400:
        - Если указан некорректный ID
        - Если плейлиста с указанным ID не существует
      403:
        - Если пользователь, который отправил запрос, не является создателем плейлиста


  edit:
    mark: 'T'
    name: 'Изменить'
    link: '[POST] /mashup/edit'

    body:
      playlistName: 'Новый плейлист'
      imageFile: '[Base64 decoded png/jpg file]'
      comment: 'Нужно указывать поля только в том случае, если их значения были изменены пользователем'

    answer:
      playlistName: 'Новый плейлист'
      imageUrl: '61a8f47d24e73d69ef53d1145976f97101d969a1c3cb719ad4a96d21b257949e'

    regex:
      playlistName: "^[а-яА-ЯёЁa-zA-Z0-9_\\$.,=+()*&^%$#@!\\-?':\\| ]{4,48}$"
      'tracksUrls | YouTube': 'https://www\.youtube\.com/watch\?v=([-a-zA-Z0-9_]{11})'
      'tracksUrls | Яндекс.Музыка': 'https://music\.yandex\.ru/album/(\d+)/track/(\d+)'

    codes:
      200:
        - Если всё хорошо и слава тебе, Господи
      400:
        - Если указан некорректный ID
        - Если плейлист с указанным ID не существует
        - Если указан некорректный формат данных в теле запроса
        - Если указанное название не соответствует регулярному выражению
        - Если изображение является прозрачным
        - Если изображение меньше 800х800 пикселей
      403:
        - Если пользователь, который отправил запрос, не является создателем плейлиста или вовсе забанен
      413:
        - Если изображение весит больше 5 МБ
      500:
        - Если невозможно декодировать изображение
        - Если произошло какое-то IO исключение при работе с изображением


  add_mashup:
    mark: 'T'
    name: 'Добавить мэшап'
    link: '[POST] /playlist/add_mashup?playlistId=[PID]&id=[ID]'

    regex:
      PID: '\d+'
      ID: '\d+'

    codes:
      200:
        - Если мэшап был добавлен в плейлист
      400:
        - Если хотя бы один из указанных ID некорректный
        - Если мэшап с указанным ID не существует
        - Если плейлиста с указанным ID не существует
        - Если в плейлисте уже есть указанный мэшап
        - Если в плейлисте уже есть 100 мэшапов
      403:
        - Если пользователь, который отправил запрос, не является создателем плейлиста


  remove_mashup:
    mark: 'T'
    name: 'Удалить мэшап'
    link: '[POST] /playlist/remove_mashup?playlistId=[PID]&id=[ID]'

    regex:
      PID: '\d+'
      ID: '\d+'

    codes:
      200:
        - Если мэшап был удалён из плейлиста
      400:
        - Если хотя бы один из указанных ID некорректный
        - Если мэшап с указанным ID не существует
        - Если плейлиста с указанным ID не существует
        - Если в плейлисте нет указанного мэшапа
      403:
        - Если пользователь, который отправил запрос, не является создателем плейлиста


  add_stream:
    mark: 'T'
    name: 'Добавить прослушивание'
    link: '[POST] /playlists/stream/add?id=[ID]'
    description: '**`[!]`** Должен быть вызван раз в 60 секунд, иначе прослушивание не будет добавлено.'

    regex:
      ID: '\d+'

    codes:
      200:
        - Если прослушивание добавилось
      208:
        - Если менее 60 секунд назад было добавлено другое прослушивание
      400:
        - Если указан некорректный ID
        - Если плейлист с указанным ID не найден

  add_like:
    mark: 'T'
    name: 'Добавить лайк'
    link: '[POST] /playlist/like/add?id=[ID]'
    description: '**`[!]`** В идеале должен быть хоть какой-то таймаут, но время таймаута надо обсудить.'

    regex:
      ID: '\d+'

    codes:
      200:
        - Если лайк добавился или уже был добавлен
      400:
        - Если указан некорректный ID
        - Если плейлист с указанным ID не найден


  delete_like:
    mark: 'T'
    name: 'Убрать лайк'
    link: '[POST] /playlist/like/delete?id=[ID]'

    regex:
      ID: '\d+'

    codes:
      200:
        - Если лайк убрался или уже был убран
      400:
        - Если указан некорректный ID
        - Если плейлист с указанным ID не найден
